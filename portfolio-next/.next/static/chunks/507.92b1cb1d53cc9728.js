"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[507],{4063:function(t){t.exports=function t(e,r){if(e===r)return!0;if(e&&r&&"object"==typeof e&&"object"==typeof r){if(e.constructor!==r.constructor)return!1;if(Array.isArray(e)){if((n=e.length)!=r.length)return!1;for(o=n;0!=o--;)if(!t(e[o],r[o]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if((n=(i=Object.keys(e)).length)!==Object.keys(r).length)return!1;for(o=n;0!=o--;)if(!Object.prototype.hasOwnProperty.call(r,i[o]))return!1;for(o=n;0!=o--;){var n,o,i,s=i[o];if(!t(e[s],r[s]))return!1}return!0}return e!=e&&r!=r}},7507:function(t,e,r){r.r(e),r.d(e,{groq:function(){return n},groqStore:function(){return b}});var n=r(2870),o=r(4063),i=r(4840),s=["Value","Copy","Blank","ReturnIntoArray","ReturnIntoObject","ReturnIntoObjectSameKey","PushField","PushElement","PushParent","Pop","PushFieldCopy","PushFieldBlank","PushElementCopy","PushElementBlank","ReturnIntoObjectPop","ReturnIntoObjectSameKeyPop","ReturnIntoArrayPop","ObjectSetFieldValue","ObjectCopyField","ObjectDeleteField","ArrayAppendValue","ArrayAppendSlice","StringAppendString","StringAppendSlice"],u=function(){function t(t,e,r){this.i=0,this.inputStack=[],this.outputStack=[],this.model=t,this.root=e,this.patch=r}return t.prototype.read=function(){return this.patch[this.i++]},t.prototype.process=function(){for(this.inputStack.push({value:this.root}),this.outputStack.push({value:this.root});this.i<this.patch.length;){var t=this.read(),e=s[t];if(!e)throw Error("Unknown opcode: "+t);this["process"+e].apply(this)}var r=this.outputStack.pop();return this.finalizeOutput(r)},t.prototype.inputEntry=function(){return this.inputStack[this.inputStack.length-1]},t.prototype.inputKey=function(t,e){return t.keys||(t.keys=this.model.objectGetKeys(t.value).sort()),t.keys[e]},t.prototype.outputEntry=function(){return this.outputStack[this.outputStack.length-1]},t.prototype.outputArray=function(){var t=this.outputEntry();return t.writeValue||(t.writeValue=this.model.copyArray(t.value)),t.writeValue},t.prototype.outputObject=function(){var t=this.outputEntry();return t.writeValue||(t.writeValue=this.model.copyObject(t.value)),t.writeValue},t.prototype.outputString=function(){var t=this.outputEntry();return t.writeValue||(t.writeValue=this.model.copyString(t.value)),t.writeValue},t.prototype.finalizeOutput=function(t){return t.writeValue?this.model.finalize(t.writeValue):t.value},t.prototype.processValue=function(){var t=this.model.wrap(this.read());this.outputStack.push({value:t})},t.prototype.processCopy=function(){var t=this.inputEntry();this.outputStack.push({value:t.value})},t.prototype.processBlank=function(){this.outputStack.push({value:null})},t.prototype.processReturnIntoArray=function(){var t=this.outputStack.pop(),e=this.finalizeOutput(t),r=this.outputArray();this.model.arrayAppendValue(r,e)},t.prototype.processReturnIntoObject=function(){var t=this.read(),e=this.outputStack.pop(),r=this.finalizeOutput(e);r=this.model.markChanged(r);var n=this.outputObject();this.model.objectSetField(n,t,r)},t.prototype.processReturnIntoObjectSameKey=function(){var t=this.inputEntry(),e=this.outputStack.pop(),r=this.finalizeOutput(e),n=this.outputObject();this.model.objectSetField(n,t.key,r)},t.prototype.processPushField=function(){var t=this.read(),e=this.inputEntry(),r=this.inputKey(e,t),n=this.model.objectGetField(e.value,r);this.inputStack.push({value:n,key:r})},t.prototype.processPushElement=function(){var t=this.read(),e=this.inputEntry(),r=this.model.arrayGetElement(e.value,t);this.inputStack.push({value:r})},t.prototype.processPop=function(){this.inputStack.pop()},t.prototype.processPushFieldCopy=function(){this.processPushField(),this.processCopy()},t.prototype.processPushFieldBlank=function(){this.processPushField(),this.processBlank()},t.prototype.processPushElementCopy=function(){this.processPushElement(),this.processCopy()},t.prototype.processPushElementBlank=function(){this.processPushElement(),this.processBlank()},t.prototype.processReturnIntoObjectPop=function(){this.processReturnIntoObject(),this.processPop()},t.prototype.processReturnIntoObjectSameKeyPop=function(){this.processReturnIntoObjectSameKey(),this.processPop()},t.prototype.processReturnIntoArrayPop=function(){this.processReturnIntoArray(),this.processPop()},t.prototype.processObjectSetFieldValue=function(){this.processValue(),this.processReturnIntoObject()},t.prototype.processObjectCopyField=function(){this.processPushField(),this.processCopy(),this.processReturnIntoObjectSameKey(),this.processPop()},t.prototype.processObjectDeleteField=function(){var t=this.read(),e=this.inputEntry(),r=this.inputKey(e,t),n=this.outputObject();this.model.objectDeleteField(n,r)},t.prototype.processArrayAppendValue=function(){var t=this.model.wrap(this.read()),e=this.outputArray();this.model.arrayAppendValue(e,t)},t.prototype.processArrayAppendSlice=function(){var t=this.read(),e=this.read(),r=this.outputArray(),n=this.inputEntry().value;this.model.arrayAppendSlice(r,n,t,e)},t.prototype.processStringAppendString=function(){var t=this.model.wrap(this.read()),e=this.outputString();this.model.stringAppendValue(e,t)},t.prototype.processStringAppendSlice=function(){var t=this.read(),e=this.read(),r=this.outputString(),n=this.inputEntry().value;this.model.stringAppendSlice(r,n,t,e)},t}();function a(t,e,r){void 0===r&&(r=0);var n=r,o=0;for(o=r;n<e;o++){var i,s=(i=t.codePointAt(o))>>16?4:i>>11?3:i>>7?2:1;4===s&&o++,n+=s}return o}var c={wrap:function(t){return t},finalize:function(t){return Array.isArray(t)?t:t.data},markChanged:function(t){return t},objectGetKeys:function(t){return Object.keys(t)},objectGetField:function(t,e){return t[e]},arrayGetElement:function(t,e){return t[e]},copyObject:function(t){var e={type:"object",data:{}};if(null!==t)for(var r=0,n=Object.entries(t);r<n.length;r++){var o=n[r],i=o[0],s=o[1];e.data[i]=s}return e},copyArray:function(t){return null===t?[]:t.slice()},copyString:function(t){return{type:"string",data:null===t?"":t}},objectSetField:function(t,e,r){t.data[e]=r},objectDeleteField:function(t,e){delete t.data[e]},arrayAppendValue:function(t,e){t.push(e)},arrayAppendSlice:function(t,e,r,n){t.push.apply(t,e.slice(r,n))},stringAppendSlice:function(t,e,r,n){var o=a(e,r),i=a(e,n,o);t.data+=e.slice(o,i)},stringAppendValue:function(t,e){t.data+=e}};function p(){return(p=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}let l=(t,e,r)=>{"undefined"!=typeof window&&t.addEventListener===window.EventSource.prototype.addEventListener&&t.addEventListener(e,r,!1),t.addEventListener(e,r)};function d(t){return t._id.startsWith("drafts.")?t._id.slice(7):t._id}function h(t,e){let r=p({},t);return delete r._rev,new u(c,r,e).process()}function f(){return Promise.resolve()}let y,v=t=>t,m=async function({projectId:t,dataset:e,token:r,documentLimit:n}){var o,i;let s,u;let a=`https://${t}.api.sanity.io/v1/data/export/${e}`,c=r?{Authorization:`Bearer ${r}`}:void 0,p=await fetch(a,{credentials:"include",headers:c});if(200!==p.status)throw Error(`Error streaming dataset: ${"object"==typeof(o=await p.json())&&"error"in o&&"message"in o?o.message||o.error:"<unknown error>"}`);let l=function(t){if(!t)throw Error("Failed to read body from response");let e,r=!1;function n(){r=!0,e&&e.cancel()}return new ReadableStream({start(o){e=t.getReader();let i=new TextDecoder,s="";e.read().then(async function t(u){if(u.done){if(r)return;return 0===(s=s.trim()).length||o.enqueue(JSON.parse(s)),void o.close()}s+=i.decode(u.value,{stream:!0});let a=s.split("\n");for(let c=0;c<a.length-1;++c){let p=a[c].trim();if(0!==p.length)try{o.enqueue(JSON.parse(p))}catch(l){return o.error(l),void n()}}if(s=a[a.length-1],e)try{t(await e.read())}catch(d){o.error(d)}}).catch(t=>o.error(t))},cancel:n})}(p.body),d=l.getReader(),h=[];do{if((i=u=(s=await d.read()).value)&&"error"in i&&"object"==typeof i.error&&null!==i.error&&"description"in i.error&&"string"==typeof i.error.description&&!("_id"in i))throw Error(`Error streaming dataset: ${u.error}`);if(u&&!u._id.startsWith("_.")&&h.push(u),n&&h.length>n)throw d.cancel("Reached document limit"),Error(`Error streaming dataset: Reached limit of ${n} documents`)}while(!s.done);return h};function b(t){var e;!function(){let t=["EventSource","ReadableStream","fetch"].filter(t=>!(t in window));if(t.length>0)throw Error(`Browser not supported. Missing browser APIs: ${t.join(", ")}`)}();let r=null!=(e=t.EventSource)?e:window.EventSource;if(t.token&&r===window.EventSource)throw Error("When`token` option is used, `EventSource` option must also be provided. EventSource cannot be `window.EventSource`, as it does not support passing a token.");return function(t,e){let r,s=[],u=function(t,e,r){var n,o={},i=o.noTrailing,s=void 0!==i&&i,u=o.noLeading,a=void 0!==u&&u,c=o.debounceMode,p=void 0===c?void 0:c,l=!1,d=0;function h(){n&&clearTimeout(n)}function f(){for(var r=arguments.length,o=Array(r),i=0;i<r;i++)o[i]=arguments[i];var u=this,c=Date.now()-d;function f(){d=Date.now(),e.apply(u,o)}function y(){n=void 0}!l&&(a||!p||n||f(),h(),void 0===p&&c>t?a?(d=Date.now(),s||(n=setTimeout(p?y:f,t))):f():!0!==s&&(n=setTimeout(p?y:f,void 0===p?t-c:t)))}return f.cancel=function(t){var e=(t||{}).upcomingOnly;h(),l=!(void 0!==e&&e)},f}(t.subscriptionThrottleMs||50,function(){a.forEach(b)}),a=[];async function c(){r||(r=function(t,e,{getDocuments:r,EventSource:n}){let o,i,s,u,a,c;let{projectId:y,dataset:v,listen:m,overlayDrafts:b,documentLimit:g,token:w}=t;if(!m)return{unsubscribe:f,loaded:r({projectId:y,dataset:v,documentLimit:g,token:w}).then(k).then(f)};let S=new Map,E=[],j=new Promise((t,e)=>{i=t,s=e});return{unsubscribe:function(t,e,r){var n;let{projectId:o,dataset:i,token:s}=e,u=new t(`https://${o}.api.sanity.io/v1/data/listen/${i}?query=*&effectFormat=mendoza`,{withCredentials:!0,headers:s?{Authorization:`Bearer ${s}`}:void 0});return l(u,"welcome",r.open),l(u,"mutation",(n=r.next,t=>{let e;try{e=JSON.parse(t.data)}catch(r){return}n(e)})),l(u,"channelError",t=>{let e;u.close();try{e=JSON.parse(t.data)}catch(n){return void r.error(Error("Unknown error parsing listener message"))}r.error(Error(e.message||e.error||`Listener returned HTTP ${e.statusCode}`))}),l(u,"error",t=>{let e="undefined"!=typeof window&&window.location.origin,n=e?`, and that the CORS-origin (${e}) is allowed`:"",o="object"==typeof t&&null!==t&&"message"in t?` (${t.message})`:"";r.error(Error(`Error establishing listener - check that the project ID and dataset are correct${n}${o}`))}),{unsubscribe:()=>Promise.resolve(u.close())}}(n,t,{next:function(t){var e;o?(function(t){if(!t.effects||t.documentId.startsWith("_."))return;let e=S.get(t.documentId)||null;!function(t,e){let r=S.get(t),n=o||[],i=r?n.indexOf(r):-1;-1===i&&e?(n.push(e),S.set(t,e)):e?(n.splice(i,1,e),S.set(t,e)):(n.splice(i,1),S.delete(t))}(t.documentId,h(e,t.effects.apply))}(t),e=o,clearTimeout(c),a!==t.transactionId&&u?(k(u),a=void 0):(a=t.transactionId,u=e.slice()),c=setTimeout(k,25,e.slice())):E.push(t)},open:async function(){let t=await r({projectId:y,dataset:v,documentLimit:g,token:w});(o=function(t,e){let r=new Map;return e.forEach(t=>{let e=r.get(t.documentId)||[];e.push(t),r.set(t.documentId,e)}),r.forEach((e,r)=>{let n=t.find(t=>t._id===r);if(!n)return void console.warn("Received mutation for missing document %s",r);let o=!1,i=n;e.forEach(t=>{(o=o||t.previousRev===n._rev)&&t.effects&&(i=h(i,t.effects.apply))}),t.splice(t.indexOf(n),1,i)}),t}(t,E)).forEach(t=>S.set(t._id,t)),k(o),i()},error:t=>s(t)}).unsubscribe,loaded:j};function k(t){u=void 0,c=void 0,a=void 0,e(b?function(t){let e=new Map;return t.forEach(t=>{let r=e.get(d(t));t._id.startsWith("drafts.")?e.set(d(t),p({},t,{_id:d(t)})):r||e.set(t._id,t)}),Array.from(e.values())}(t):t)}}(t,t=>{s=t,u()},e)),await r.loaded}async function m(t,e){await c();let r=(0,i.Q)(t,{params:e});return(await (0,i.k)(r,{dataset:s,params:e})).get()}function b(t){return m(t.query,t.params).then(e=>{"previousResult"in t&&o(t.previousResult,e)||(t.previousResult=e,t.callback(void 0,e))}).catch(e=>{t.callback(e)})}return{query:m,getDocument:async function(t){return await c(),m(n(y||(y=v`*[_id == $id][0]`)),{id:t})},getDocuments:async function(t){return await c(),m(`[${t.map(t=>`*[_id == "${t}"][0]`).join(",\n")}]`)},subscribe:function(e,r,n){if(!t.listen)throw Error("Cannot use `subscribe()` without `listen: true`");let o={query:e,params:r,callback:n};a.push(o);let i=!1;return b(o),{unsubscribe:()=>(i||(i=!0,a.splice(a.indexOf(o),1)),Promise.resolve())}},close:function(){return u.cancel(),r?r.unsubscribe():Promise.resolve()}}}(t,{EventSource:r,getDocuments:m})}}}]);